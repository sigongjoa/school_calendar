# 07. 프론트엔드 페이지 명세

## 라우팅 구조

```typescript
// App.tsx
<Routes>
  <Route path="/" element={<CalendarPage />} />
  <Route path="/schools" element={<SchoolSchedulePage />} />
</Routes>
```

공통 레이아웃: `Header` 컴포넌트가 상단에 고정, 페이지 전환 네비게이션 포함.

---

## 페이지 1: CalendarPage (통합 캘린더)

### 경로: `/`

### 레이아웃

```
┌─────────────────────────────────────────────────────┐
│  Header (아카데미 매니저 / 네비게이션)                   │
├──────────┬──────────────────────────────────────────┤
│ Sidebar  │  CalendarNav (뷰 토글, 이전/오늘/다음)      │
│ (256px)  ├──────────────────────────────────────────┤
│          │                                          │
│ 학교필터  │  CalendarGrid (월간 캘린더)                 │
│ 토글목록  │  ┌───┬───┬───┬───┬───┬───┬───┐          │
│          │  │일 │월 │화 │수 │목 │금 │토 │          │
│          │  ├───┼───┼───┼───┼───┼───┼───┤          │
│          │  │   │   │   │   │   │   │   │          │
│          │  │   │   │   │   │   │   │   │          │
│          │  │   │   │   │   │   │   │   │          │
│          │  │   │   │   │   │   │   │   │          │
│          │  └───┴───┴───┴───┴───┴───┴───┘          │
│          ├──────────────────────────────────────────┤
│          │  범례 (Legend)                             │
└──────────┴──────────────────────────────────────────┘
```

### 사이드바 구성

1. **제목**: "학사일정 캘린더" + 부제 "통합 학사 캘린더"
2. **학교 선택 필터** (`SchoolToggleList`):
   - 등록된 학교별 체크박스
   - 체크박스 옆 학교명 + 우측 색상 점
   - 체크 on/off → 캘린더에 해당 학교 일정 표시/숨김
   - 체크 상태는 `useSchoolStore.toggleSchool(id)` 호출
3. **학교 추가 버튼**: 사이드바 하단, 클릭 시 `SchoolAddModal` 표시

### 캘린더 영역 구성

1. **상단 바**
   - 좌측: 페이지 제목 "학사일정 통합 캘린더" + 현재 년/월
   - 우측: 뷰 토글 (일간/주간/월간) + 네비게이션 (◀ 오늘 ▶)

2. **캘린더 그리드** (`CalendarGrid`)
   - 7열 x 5~6행 그리드
   - 각 셀 = `CalendarCell`
   - 요일 헤더: 일(빨간) 월~금(회색) 토(파란)
   - 이번 달이 아닌 날짜는 흐리게 (bg-gray-50, text-gray-300)
   - 오늘 날짜는 primary 색상 강조

3. **셀 내부** (`CalendarCell`):
   ```
   ┌─────────────────────┐
   │ [시험기간 바]         │ ← ExamPeriodBar (학교 색상)
   │ 15                   │ ← 날짜 숫자
   │ 🟠 대치고 중간고사     │ ← EventBadge
   │ 🔵 한티중 시험대비     │ ← EventBadge
   │                      │
   └─────────────────────┘
   ```
   - 시험 기간: 셀 상단에 학교 색상 바 (높이 4px)
   - 이벤트 뱃지: 카테고리별 색상, 학교명 포함
   - 이벤트 3개 초과 시: "+2 더보기" 텍스트

4. **하단 범례**:
   - 카테고리별 색상 + 라벨 (시험, 공휴일, 학교행사, 방학, 기타)

### 인터랙션

| 액션 | 결과 |
|------|------|
| 학교 토글 체크/해제 | 해당 학교 이벤트 즉시 캘린더에 표시/숨김 |
| 이전달/다음달 클릭 | 월 이동, API 호출로 해당 월 일정 로드 |
| 오늘 버튼 | 현재 월로 이동 |
| 뷰 토글 (월/주/일) | MVP에서는 월간만 구현, 나머지는 비활성 |
| 이벤트 뱃지 호버 | 툴팁으로 상세 정보 표시 (선택 구현) |

### 데이터 로딩

```typescript
// CalendarPage.tsx 핵심 로직
const { currentYear, currentMonth } = useCalendarStore();
const { enabledSchoolIds } = useSchoolStore();
const { events, examPeriods, fetchCalendar } = useScheduleStore();

useEffect(() => {
  fetchCalendar(currentYear, currentMonth);
}, [currentYear, currentMonth]);

// enabledSchoolIds 변경 시 이벤트 필터링만 (재호출 불필요)
const filteredEvents = events.filter(e => enabledSchoolIds.includes(e.schoolId));
```

---

## 페이지 2: SchoolSchedulePage (학교별 일정 관리)

### 경로: `/schools`

### 레이아웃

```
┌─────────────────────────────────────────────────────┐
│  Header (아카데미 매니저 / 네비게이션)                   │
├──────────┬──────────────────────────────────────────┤
│ Sidebar  │  Breadcrumb: 설정 / 학사일정 관리           │
│ (320px)  ├──────────────────────────────────────────┤
│          │  PageHeading + "외부 일정 가져오기" 버튼     │
│ 학교목록  ├──────────────────────────────────────────┤
│          │  ActionsBar (이벤트 추가, 내보내기 등)       │
│ - 서울고  ├──────────────────────────────────────────┤
│ - 경기중  │                                          │
│ - 한국초  │  ScheduleTable (일정 테이블)               │
│ - ...    │  ┌──────┬──────┬──────┬──────┬───┐       │
│          │  │날짜  │구분  │이벤트│상태  │관리│       │
│          │  ├──────┼──────┼──────┼──────┼───┤       │
│ [학교추가]│  │04.18 │시험  │중간..│예정  │✏🗑│       │
│          │  │05.05 │공휴일│어린..│확정  │✏🗑│       │
│          │  └──────┴──────┴──────┴──────┴───┘       │
│          ├──────────────────────────────────────────┤
│          │  StatsCards (이번 달 일정 / 잔여 휴일 / 등) │
└──────────┴──────────────────────────────────────────┘
```

### 사이드바 구성 (`SchoolListSidebar`)

1. **제목**: "학교 목록" + 총 개수 표시
2. **학교 리스트**:
   - 선택된 학교: primary 배경 + 좌측 4px 보더 강조
   - 클릭 시 해당 학교의 일정을 메인 영역에 표시
   - 학교 아이콘 + 학교명
3. **학교 추가 버튼**: 하단 고정

### 메인 영역 구성

1. **Breadcrumb**: 설정 > 학사일정 관리
2. **PageHeading**: 학교명 + 설명 + "외부 일정 가져오기(동기화)" 버튼
3. **ActionsBar**: 아이콘 버튼 그룹
   - "이벤트 추가" (수동 추가, scope 외이므로 비활성화 가능)
   - "내보내기" (JSON/CSV 다운로드)
   - "인쇄"
   - "변경 이력" (선택 구현)
4. **ScheduleTable**: 학사일정 테이블
   - 컬럼: 날짜, 구분(카테고리 뱃지), 이벤트명, 상태, 관리(편집/삭제 아이콘)
   - 날짜순 정렬
   - "더 보기" 버튼으로 페이지네이션
   - 상태: 확정 / 진행 예정 / 대기 (날짜 기준 자동 계산)
5. **StatsCards**: 3열 그리드
   - 이번 달 주요 일정 수
   - 학기 잔여 휴일 수 + 프로그레스 바
   - 마지막 동기화 시각

### 인터랙션

| 액션 | 결과 |
|------|------|
| 사이드바 학교 클릭 | 해당 학교 일정으로 테이블 전환 |
| "외부 일정 가져오기" 클릭 | 선택된 학교의 나이스 동기화 실행 |
| 테이블 "더 보기" | 추가 일정 로드 (또는 전체 표시) |
| "학교 추가" 버튼 | SchoolAddModal 표시 |
| 삭제 아이콘 | 해당 이벤트 삭제 확인 후 삭제 |

### 이벤트 상태 자동 계산

```typescript
function getEventStatus(event: SchoolEvent): string {
  const today = new Date();
  const eventDate = new Date(event.date);
  const endDate = event.endDate ? new Date(event.endDate) : eventDate;

  if (endDate < today) return '완료';
  if (eventDate <= today && today <= endDate) return '진행중';
  // 7일 이내
  const diffDays = (eventDate.getTime() - today.getTime()) / (1000 * 60 * 60 * 24);
  if (diffDays <= 7) return '진행 예정';
  return '대기';
}
```

---

## 학교 추가 모달 (SchoolAddModal)

두 페이지에서 공통 사용.

### 플로우

1. 학교명 입력 (검색어)
2. "검색" 버튼 → `GET /api/schools/search?keyword=` 호출
3. 검색 결과 리스트 표시 (학교명, 주소, 학교유형)
4. 원하는 학교 선택 → 색상 선택 (프리셋에서)
5. "추가" 버튼 → `POST /api/schools` 호출
6. 추가 완료 → 자동으로 초기 동기화 실행
7. 모달 닫기

### 레이아웃

```
┌──────────────────────────────────┐
│  학교 추가                    [X] │
├──────────────────────────────────┤
│  [  학교명 입력...     ] [검색]   │
├──────────────────────────────────┤
│  검색 결과:                       │
│  ○ 대치고등학교 (고/서울 강남구)    │
│  ● 대치중학교  (중/서울 강남구)    │ ← 선택됨
│  ○ 대치초등학교 (초/서울 강남구)   │
├──────────────────────────────────┤
│  색상 선택:                       │
│  🟠 🔵 🟢 🔴 🟣 💗 (원형 버튼)    │
├──────────────────────────────────┤
│          [취소]  [추가]           │
└──────────────────────────────────┘
```
